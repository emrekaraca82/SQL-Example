1)CUSTOMERS TABLOSU ADI A İLE BAŞLAYAN MÜŞTERİLERİ LİSTELEYİNİZ.
SELECT NAMESURNAME FROM CUSTOMERS WHERE NAMESURNAME LIKE 'a%' 

2)CUSTOMERS TABLOSU ADI A İLE BAŞLAYAN VE ERKEK MÜŞTERİLERİ LİSTELEYİNİZ.
SELECT NAMESURNAME FROM CUSTOMERS WHERE NAMESURNAME LIKE 'a%' AND GENDER ='E'

3)CUSTOMERS TABLOSU DOĞUM YILI 1990 VE 1995 ARASINDA MÜŞTERİLERİ LİSTELEYİNİZ.
SELECT YEAR(BIRTHDATE) DOGUMYIL FROM CUSTOMERS WHERE YEAR(BIRTHDATE) BETWEEN 1990 AND 1995

4)CUSTOMERS TABLOSU DOĞUM YILI 1990 VE 1995 ARASINDA MÜŞTERİLERİ GRUPLAYINIZ.
SELECT YEAR(BIRTHDATE),COUNT(BIRTHDATE) AS DOGUMYIL FROM CUSTOMERS WHERE YEAR(BIRTHDATE) BETWEEN 1990 AND 1995 GROUP BY YEAR(BIRTHDATE) 

5)İSTANBULDA YAŞAYAN KİŞİLERİ JOİN KULLANIRAK LİSTELEYİNİZ.
SELECT C.*,CT.CITY FROM CUSTOMERS C INNER JOIN CITIES CT ON C.CITYID=CT.ID WHERE CT.CITY='İSTANBUL'

6)İSTANBULDA YAŞAYAN KİŞİLERİ SUBQUERY KULLANIRAK LİSTELEYİNİZ.
SELECT * FROM CUSTOMERS C WHERE  C.CITYID IN
(SELECT ID FROM CITIES WHERE CITY = 'İSTANBUL');

SELECT (SELECT CITY FROM CITIES WHERE ID=C.CITYID),* FROM CUSTOMERS C 
WHERE (SELECT CITY FROM CITIES WHERE ID=C.CITYID)='İSTANBUL'

7)ŞEHİRE GÖRE MÜŞTERİ SAYISINI GETİREN SORGU YAZINIZ.
SELECT CT.CITY,COUNT(CT.ID) AS MÜSTERİ_SAYISI FROM CUSTOMERS C INNER JOIN CITIES CT ON C.CITYID=CT.ID GROUP BY CT.CITY

8)10 DAN FAZLA MÜŞTERİ OLAN ŞEHİRLERİ FAZLADAN AZA DOĞRU SIRALAYINIZ.
SELECT CT.CITY,COUNT(CT.ID) AS MÜSTERİ_SAYISI FROM CUSTOMERS C
INNER JOIN CITIES CT ON C.CITYID=CT.ID GROUP BY CT.CITY  HAVING COUNT(CT.ID)>10  ORDER BY COUNT(CT.ID) DESC

9)HANGİ ŞEHİRDE KAÇ KADIN, KAÇ ERKEK MÜŞTERİ SIRALAYINIZ.
SELECT CT.CITY,C.GENDER,COUNT(CT.ID) AS MÜSTERİ_SAYISI FROM CUSTOMERS C
INNER JOIN CITIES CT ON C.CITYID=CT.ID  GROUP BY C.GENDER,CT.CITY ORDER BY CT.CITY,C.GENDER

SELECT CT.CITY,C.GENDER,COUNT(CT.ID) AS MÜSTERİ_SAYISI FROM CUSTOMERS C
INNER JOIN CITIES CT ON C.CITYID=CT.ID  GROUP BY C.GENDER,CT.CITY HAVING GENDER='E' OR GENDER='K'

10)HANGİ ŞEHİRDE KAÇ ERKEK ,KAÇ KADIN OLAN MÜŞTERİ BİLGİ SAYISINI GETİREN SORGU YAZINIZ
SELECT CITY AS SEHIR_ADI,
(SELECT COUNT(*) FROM CUSTOMERS WHERE CITYID = C.ID) AS MUSTERI_SAYISI,
(SELECT COUNT(*) FROM CUSTOMERS WHERE CITYID = C.ID AND GENDER='E') AS ERKEK_SAYISI,
(SELECT COUNT(*) FROM CUSTOMERS WHERE CITYID = C.ID AND GENDER='K') AS KADIN_SAYISI
FROM CITIES C

11)CUSTOMERS TABLOSUNDA MÜŞTERİ SAYISINA GÖRE HESAPLAYINIZ
SELECT AGEGROUP2,COUNT(TMP.ID) AS CUSTOMERS_COUNT FROM
(SELECT *,
CASE
	WHEN DATEDIFF(YEAR,BIRTHDATE,GETDATE()) BETWEEN 20 AND 35 THEN '20-30 ARASI'
	WHEN DATEDIFF(YEAR,BIRTHDATE,GETDATE()) BETWEEN 36 AND 45 THEN '36-45 ARASI'
	WHEN DATEDIFF(YEAR,BIRTHDATE,GETDATE()) BETWEEN 46 AND 55 THEN '46-55 ARASI'
	WHEN DATEDIFF(YEAR,BIRTHDATE,GETDATE()) BETWEEN 56 AND 65 THEN '56-65 ARASI'
	WHEN DATEDIFF(YEAR,BIRTHDATE,GETDATE()) > 65 THEN '65 YAŞ ÜSTÜ'
END AGEGROUP2
FROM CUSTOMERS
) TMP
GROUP BY AGEGROUP2
12)İSTANBULDA YAŞAYIPDA KADIKÖY DIŞINDAKİ GETİREN SQL SORGUSU YAZINIZ
SELECT * FROM CUSTOMERS C
 INNER JOIN CITIES CT ON CT.ID = C.CITYID
 INNER JOIN DISTRICTS D ON D.ID = C.DISTRICTID
 WHERE CT.CITY='İSTANBUL' AND D.DISTRICT NOT IN('KADIKÖY')

13)TLF NUMARALARININ OPERATOR BİLGİSİ GETİREN SORGU YAZINIZ
SELECT *,
SUBSTRING(TELNR1, 2, 3) AS OPERATOR1 ,
SUBSTRING(TELNR2, 2, 3) AS OPERATOR2 
FROM CUSTOMERS

SELECT *,
LEFT(TELNR1,5) AS OPERATOR1 ,
LEFT(TELNR2,5) AS OPERATOR2 
FROM CUSTOMERS

14)
SELECT 
SUM(TELNR1_XOPERATORCOUNT+TELNR2_XOPERATORCOUNT) AS XOPERATOR_COUNT,
SUM(TELNR1_YOPERATORCOUNT+TELNR2_YOPERATORCOUNT) AS YOPERATOR_COUNT,
SUM(TELNR1_ZOPERATORCOUNT+TELNR2_ZOPERATORCOUNT) AS ZOPERATOR_COUNT
FROM
(

SELECT
CASE
	WHEN TELNR1 LIKE '(50%' OR TELNR1 LIKE '(55%' THEN 1 
	ELSE 0
END AS TELNR1_XOPERATORCOUNT,

CASE
	WHEN TELNR1 LIKE '(54%' THEN 1 
	ELSE 0
END AS TELNR1_YOPERATORCOUNT,

CASE
	WHEN TELNR1 LIKE '(53%' THEN 1 
	ELSE 0
END AS TELNR1_ZOPERATORCOUNT,

CASE
	WHEN TELNR2 LIKE '(50%' OR TELNR2 LIKE '(55%' THEN 1 
	ELSE 0
END AS TELNR2_XOPERATORCOUNT,

CASE
	WHEN TELNR2 LIKE '(54%' THEN 1 
	ELSE 0
END AS TELNR2_YOPERATORCOUNT,

CASE
	WHEN TELNR2 LIKE '(53%' THEN 1 
	ELSE 0
END AS TELNR2_ZOPERATORCOUNT,

* FROM CUSTOMERS
) T

15)HER İLDE EN ÇOK MÜŞTERİYE  SAHİP OLDUĞUMUZ İLÇELERİ MÜŞTERİ SAYISINA GÖRE ÇOKTAN AZA DOĞRU SIRALAYINIZ.
SELECT CT.CITY,D.DISTRICT,COUNT(C.ID) AS CUSTOMER_COUNT FROM CUSTOMERS C 
INNER JOIN CITIES CT ON CT.ID = C.CITYID
INNER JOIN DISTRICTS D ON D.ID = C.DISTRICTID
GROUP BY CT.CITY,D.DISTRICT
ORDER BY CT.CITY,COUNT(C.ID) DESC

16)MÜŞTERİLERİN DOĞUM GÜNLERİNİ HAFTANIN GÜNÜ OLARAK YAZINIZ.
SET language turkish
SELECT NAMESURNAME,
DATENAME(DW,BIRTHDATE) AS "DOGUM_GUNU"
FROM CUSTOMERS

17)DOĞUM GÜNÜ BUGÜN OLAN MÜŞTERİLERİ LİSTELEYEN KOD YAZINIZ.
SELECT * FROM CUSTOMERS
WHERE MONTH(BIRTHDATE) = MONTH(GETDATE()) 
AND
DAY(BIRTHDATE)= DAY(GETDATE())
 

 

 









